<title>Generated by TAPENADE</title>
<link type="text/CSS" rel="stylesheet" href="tapenade.css">
<link type="text/CSS" rel="stylesheet" href="fortranStyle.css">
<body>
<pre><a name="main_d"></a><a href="main_p.html#main" target="origFile"><code class="comment">!        Generated by TAPENADE     (INRIA, Tropics team)</code></a>
<a href="main_p.html#main" target="origFile"><code class="comment">!  Tapenade 3.9 (r5096) - 24 Feb 2014 16:53</code></a>
<a href="main_p.html#main" target="origFile"><code class="comment">!</code></a>
<a href="main_p.html#main" target="origFile"><code class="comment">!  Differentiation of main in forward (tangent) mode (with options i4 dr8 r4):</code></a>
<a href="main_p.html#main" target="origFile"><code class="comment">!   variations   of useful results: alloc(*k) alloc(*temp) alloc(*oldt)</code></a>
<a href="main_p.html#main" target="origFile"><code class="comment">!                alloc(*t)</code></a>
<a href="main_p.html#main" target="origFile"><code class="comment">!   with respect to varying inputs: alloc(*k) alloc(*temp) alloc(*oldt)</code></a>
<a href="main_p.html#main" target="origFile"><code class="comment">!                alloc(*t)</code></a>
<a href="main_p.html#main" target="origFile"><code class="comment">!   RW status of diff variables: alloc(*k):in-out alloc(*temp):in-out</code></a>
<a href="main_p.html#main" target="origFile"><code class="comment">!                alloc(*oldt):in-out alloc(*t):in-out</code></a>
<a href="main_p.html#main" target="origFile"><code class="keyword">PROGRAM </code><code class="funcname">MAIN_D</code></a>
  <a href="main_p.html#main" target="origFile"><code class="keyword">USE </code><code class="funcname">DIFFSIZES</code></a>
<a href="main_p.html#main" target="origFile"><code class="comment">!  Hint: ISIZE1OFabs should be the size of dimension 1 of array abs</code></a>
<a name="main_di0"></a><a href="main_p.html#main" target="origFile"><code class="comment">!  Hint: ISIZE2OFabs should be the size of dimension 2 of array abs</code></a>
<a name="main_di1"></a>  <a href="main_p.html#main" target="origFile"><code class="keyword">IMPLICIT NONE</code></a>
<a name="main_di2"></a>  <a href="main_p.html#maini0" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">n</code>, <code class="vardecl">ncount</code>, <code class="vardecl">i</code>, <code class="vardecl">j</code></a>
  <a href="main_p.html#maini1" target="origFile"><code class="typename">REAL </code>:: <code class="vardecl">dx</code>, <code class="vardecl">error</code>, <code class="vardecl">tol</code>, <code class="vardecl">lent</code>, <code class="vardecl">pertub</code></a>
<a name="main_di3"></a><a href="main_p.html#maini2" target="origFile"><code class="comment">!      real,allocatable,intent(in),dimension(:,:)::k</code></a>
  <a href="main_p.html#maini2" target="origFile"><code class="typename">REAL </code>:: <code class="vardecl">func</code></a>
<a name="main_di4"></a>  <a href="main_p.html#maini3" target="origFile"><code class="typename">REAL</code>, <code class="typename">DIMENSION(</code>:, :<code class="typename">)</code>, <code class="typename">ALLOCATABLE </code>:: <code class="vardecl">t</code>, <code class="vardecl">x</code>, <code class="vardecl">y</code>, <code class="vardecl">oldt</code>, <code class="vardecl">temp</code>, <code class="vardecl">k</code></a>
<a name="main_di5"></a>  <a href="main_p.html#main" target="origFile"><code class="typename">REAL</code>, DIMENSION(:, :), <code class="typename">ALLOCATABLE </code>:: <code class="vardecl">td</code>, <code class="vardecl">oldtd</code>, <code class="vardecl">tempd</code>, <code class="vardecl">kd</code></a>
  <a href="main_p.html#maini4" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">SUM</code></a>
<a name="main_di6"></a>  <a href="main_p.html#maini5" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">ABS</code></a>
  <a href="main_p.html#main" target="origFile"><code class="typename">REAL </code>:: <code class="vardecl">abs0</code>(<code class="vardecl">ISIZE1OFabs</code>, <code class="vardecl">ISIZE2OFabs</code>)</a>
<a name="main_di7"></a><a href="main_p.html#maini6" target="origFile"><code class="comment">!grid details</code></a>
  <a href="main_p.html#maini6" target="origFile">n = <code class="constant">100</code></a>
<a name="main_di7"></a>  <a href="main_p.html#maini7" target="origFile"><code class="keyword">ALLOCATE(</code>td<code class="keyword">(</code>n, n<code class="keyword">))</code></a>
<a name="main_di8"></a>  <a href="main_p.html#maini7" target="origFile">td = <code class="constant">0.0</code></a>
  <a href="main_p.html#maini7" target="origFile"><code class="keyword">ALLOCATE(</code>t<code class="keyword">(</code>n, n<code class="keyword">))</code></a>
<a name="main_di8"></a>  <a href="main_p.html#maini8" target="origFile"><code class="keyword">ALLOCATE(</code>oldtd<code class="keyword">(</code>n, n<code class="keyword">))</code></a>
<a name="main_di9"></a>  <a href="main_p.html#maini8" target="origFile">oldtd = <code class="constant">0.0</code></a>
  <a href="main_p.html#maini8" target="origFile"><code class="keyword">ALLOCATE(</code>oldt<code class="keyword">(</code>n, n<code class="keyword">))</code></a>
<a name="main_di9"></a>  <a href="main_p.html#maini9" target="origFile"><code class="keyword">ALLOCATE(</code>tempd<code class="keyword">(</code>n, n<code class="keyword">))</code></a>
<a name="main_di10"></a>  <a href="main_p.html#maini9" target="origFile">tempd = <code class="constant">0.0</code></a>
  <a href="main_p.html#maini9" target="origFile"><code class="keyword">ALLOCATE(</code>temp<code class="keyword">(</code>n, n<code class="keyword">))</code></a>
<a name="main_di10"></a>  <a href="main_p.html#maini10" target="origFile"><code class="keyword">ALLOCATE(</code>kd<code class="keyword">(</code>n, n<code class="keyword">))</code></a>
<a name="main_di11"></a>  <a href="main_p.html#maini10" target="origFile">kd = <code class="constant">0.0</code></a>
  <a href="main_p.html#maini10" target="origFile"><code class="keyword">ALLOCATE(</code>k<code class="keyword">(</code>n, n<code class="keyword">))</code></a>
<a name="main_di12"></a><a href="main_p.html#maini11" target="origFile"><code class="comment">!solution details</code></a>
<a name="main_di13"></a>  <a href="main_p.html#maini11" target="origFile">error = <code class="constant">0.0</code></a>
<a name="main_di14"></a>  <a href="main_p.html#maini12" target="origFile">tol = <code class="constant">1e-8</code></a>
<a name="main_di30"></a>  <a href="main_p.html#maini13" target="origFile">ncount = <code class="constant">0</code></a>
  <a href="main_p.html#maini14" target="origFile">pertub = <code class="constant">0</code></a>
<a name="main_di29"></a><a href="main_p.html#maini30" target="origFile"><code class="comment">!initial guess and bc</code></a>
<a name="main_di15"></a>  <a href="main_p.html#maini30" target="origFile"><code class="keyword">DO </code>i=<code class="constant">1</code>,n</a>
<a name="main_di16"></a>    <a href="main_p.html#maini29" target="origFile"><code class="keyword">DO </code>j=<code class="constant">1</code>,n</a>
<a name="main_di16"></a>      <a href="main_p.html#maini15" target="origFile"><code class="keyword">IF</code> (i .EQ. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
<a name="main_di17"></a>        <a href="main_p.html#maini16" target="origFile">td(i, j) = <code class="constant">0.0</code></a>
<a name="main_di17"></a>        <a href="main_p.html#maini16" target="origFile">t(i, j) = <code class="constant">10</code></a>
<a name="main_di18"></a>        <a href="main_p.html#maini17" target="origFile">kd(i, j) = <code class="constant">0.0</code></a>
<a name="main_di19"></a>        <a href="main_p.html#maini17" target="origFile">k(i, j) = <code class="constant">10 </code>+ pertub</a>
<a name="main_di19"></a>      <a href="main_p.html#maini15" target="origFile"><code class="keyword">ELSE </code></a><a href="main_p.html#maini18" target="origFile"><code class="keyword">IF</code> (j .EQ. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
<a name="main_di20"></a>        <a href="main_p.html#maini19" target="origFile">td(i, j) = <code class="constant">0.0</code></a>
<a name="main_di20"></a>        <a href="main_p.html#maini19" target="origFile">t(i, j) = <code class="constant">20</code></a>
<a name="main_di21"></a>        <a href="main_p.html#maini20" target="origFile">kd(i, j) = <code class="constant">0.0</code></a>
<a name="main_di22"></a>        <a href="main_p.html#maini20" target="origFile">k(i, j) = <code class="constant">5 </code>+ pertub</a>
<a name="main_di22"></a>      <a href="main_p.html#maini18" target="origFile"><code class="keyword">ELSE </code></a><a href="main_p.html#maini21" target="origFile"><code class="keyword">IF</code> (i .EQ. n) <code class="keyword">THEN</code></a>
<a name="main_di23"></a>        <a href="main_p.html#maini22" target="origFile">td(i, j) = <code class="constant">0.0</code></a>
<a name="main_di23"></a>        <a href="main_p.html#maini22" target="origFile">t(i, j) = <code class="constant">20</code></a>
<a name="main_di24"></a>        <a href="main_p.html#maini23" target="origFile">kd(i, j) = <code class="constant">0.0</code></a>
<a name="main_di25"></a>        <a href="main_p.html#maini23" target="origFile">k(i, j) = <code class="constant">1 </code>+ pertub</a>
<a name="main_di25"></a>      <a href="main_p.html#maini21" target="origFile"><code class="keyword">ELSE </code></a><a href="main_p.html#maini24" target="origFile"><code class="keyword">IF</code> (j .EQ. n) <code class="keyword">THEN</code></a>
<a name="main_di26"></a>        <a href="main_p.html#maini25" target="origFile">td(i, j) = <code class="constant">0.0</code></a>
<a name="main_di26"></a>        <a href="main_p.html#maini25" target="origFile">t(i, j) = <code class="constant">40</code></a>
        <a href="main_p.html#maini26" target="origFile">kd(i, j) = <code class="constant">0.0</code></a>
<a name="main_di27"></a>        <a href="main_p.html#maini26" target="origFile">k(i, j) = <code class="constant">50 </code>+ pertub</a>
<a name="main_di27"></a>      <a href="main_p.html#maini24" target="origFile"><code class="keyword">ELSE</code></a>
<a name="main_di28"></a>        <a href="main_p.html#maini27" target="origFile">td(i, j) = <code class="constant">0.0</code></a>
<a name="main_di28"></a>        <a href="main_p.html#maini27" target="origFile">t(i, j) = <code class="constant">0.0</code></a>
        <a href="main_p.html#maini28" target="origFile">kd(i, j) = <code class="constant">0.0</code></a>
        <a href="main_p.html#maini28" target="origFile">k(i, j) = <code class="constant">60 </code>+ pertub</a>
      <a href="main_p.html#maini15" target="origFile"><code class="keyword">END IF</code></a>
<a name="main_di31"></a>    <a href="main_p.html#maini29" target="origFile"><code class="keyword">END DO</code></a>
  <a href="main_p.html#maini30" target="origFile"><code class="keyword">END DO</code></a>
<a name="main_di32"></a><a href="main_p.html#maini31" target="origFile"><code class="comment">!solver</code></a>
<a name="main_di32"></a>  <a href="main_p.html#maini31" target="origFile"><code class="keyword">DO </code></a>
<a name="main_di35"></a>    <a href="main_p.html#maini32" target="origFile">oldtd = td</a>
<a name="main_di34"></a>    <a href="main_p.html#maini32" target="origFile">oldt = t</a>
<a name="main_di33"></a>    <a href="main_p.html#maini35" target="origFile"><code class="keyword">DO </code>i=<code class="constant">2</code>,n-<code class="constant">1</code></a>
      <a href="main_p.html#maini34" target="origFile"><code class="keyword">DO </code>j=<code class="constant">2</code>,n-<code class="constant">1</code></a>
        <a href="main_p.html#maini33" target="origFile">td(i, j) = ((td(i+<code class="constant">1</code>, j)*k(i+<code class="constant">1</code>, j)+t(i+<code class="constant">1</code>, j)*kd(i+<code class="constant">1</code>, j)+td(i-<code class="constant">1</code>, j<code class="label">&</code></a>
<a href="main_p.html#maini33" target="origFile"><code class="label">&         </code>)*k(i-<code class="constant">1</code>, j)+t(i-<code class="constant">1</code>, j)*kd(i-<code class="constant">1</code>, j)+td(i, j+<code class="constant">1</code>)*k(i, j+<code class="constant">1</code>)+t(i, j+<code class="constant">1</code><code class="label">&</code></a>
<a href="main_p.html#maini33" target="origFile"><code class="label">&         </code>)*kd(i, j+<code class="constant">1</code>)+td(i, j-<code class="constant">1</code>)*k(i, j-<code class="constant">1</code>)+t(i, j-<code class="constant">1</code>)*kd(i, j-<code class="constant">1</code>))*(k(i+<code class="constant">1</code><code class="label">&</code></a>
<a href="main_p.html#maini33" target="origFile"><code class="label">&         </code>, j)+k(i-<code class="constant">1</code>, j)+k(i, j+<code class="constant">1</code>)+k(i, j-<code class="constant">1</code>))-(t(i+<code class="constant">1</code>, j)*k(i+<code class="constant">1</code>, j)+t(i-<code class="constant">1</code><code class="label">&</code></a>
<a href="main_p.html#maini33" target="origFile"><code class="label">&         </code>, j)*k(i-<code class="constant">1</code>, j)+t(i, j+<code class="constant">1</code>)*k(i, j+<code class="constant">1</code>)+t(i, j-<code class="constant">1</code>)*k(i, j-<code class="constant">1</code>))*(kd(i+<code class="label">&</code></a>
<a name="main_di33"></a><a href="main_p.html#maini33" target="origFile"><code class="label">&         </code><code class="constant">1</code>, j)+kd(i-<code class="constant">1</code>, j)+kd(i, j+<code class="constant">1</code>)+kd(i, j-<code class="constant">1</code>)))/(k(i+<code class="constant">1</code>, j)+k(i-<code class="constant">1</code>, j)+<code class="label">&</code></a>
<a href="main_p.html#maini33" target="origFile"><code class="label">&         </code>k(i, j+<code class="constant">1</code>)+k(i, j-<code class="constant">1</code>))**<code class="constant">2</code></a>
        <a href="main_p.html#maini33" target="origFile">t(i, j) = (t(i+<code class="constant">1</code>, j)*k(i+<code class="constant">1</code>, j)+t(i-<code class="constant">1</code>, j)*k(i-<code class="constant">1</code>, j)+t(i, j+<code class="constant">1</code>)*k(i<code class="label">&</code></a>
<a href="main_p.html#maini33" target="origFile"><code class="label">&         </code>, j+<code class="constant">1</code>)+t(i, j-<code class="constant">1</code>)*k(i, j-<code class="constant">1</code>))/(k(i+<code class="constant">1</code>, j)+k(i-<code class="constant">1</code>, j)+k(i, j+<code class="constant">1</code>)+k(i<code class="label">&</code></a>
<a href="main_p.html#maini33" target="origFile"><code class="label">&         </code>, j-<code class="constant">1</code>))</a>
<a name="main_di36"></a>      <a href="main_p.html#maini34" target="origFile"><code class="keyword">END DO</code></a>
    <a href="main_p.html#maini35" target="origFile"><code class="keyword">END DO</code></a>
<a name="main_di41"></a><a href="main_p.html#maini36" target="origFile"><code class="comment">!objective func</code></a>
    <a href="main_p.html#maini36" target="origFile">func = <code class="funcname">SUM</code>(t)</a>
<a name="main_di40"></a><a href="main_p.html#maini41" target="origFile"><code class="comment">!     call solver(t,k,n)</code></a>
<a name="main_di37"></a>    <a href="main_p.html#maini41" target="origFile"><code class="keyword">DO </code>i=<code class="constant">2</code>,n-<code class="constant">1</code></a>
<a name="main_di38"></a>      <a href="main_p.html#maini40" target="origFile"><code class="keyword">DO </code>j=<code class="constant">2</code>,n-<code class="constant">1</code></a>
<a name="main_di38"></a>        <a href="main_p.html#maini37" target="origFile"><code class="keyword">IF</code> (t(i, j) - oldt(i, j) .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
          <a href="main_p.html#maini38" target="origFile">tempd(i, j) = td(i, j) - oldtd(i, j)</a>
<a name="main_di39"></a>          <a href="main_p.html#maini38" target="origFile">temp(i, j) = t(i, j) - oldt(i, j)</a>
<a name="main_di39"></a>        <a href="main_p.html#maini37" target="origFile"><code class="keyword">ELSE</code></a>
          <a href="main_p.html#maini39" target="origFile">tempd(i, j) = -(td(i, j)-oldtd(i, j))</a>
          <a href="main_p.html#maini39" target="origFile">temp(i, j) = -(t(i, j)-oldt(i, j))</a>
        <a href="main_p.html#maini37" target="origFile"><code class="keyword">END IF</code></a>
      <a href="main_p.html#maini40" target="origFile"><code class="keyword">END DO</code></a>
<a name="main_di43"></a>    <a href="main_p.html#maini41" target="origFile"><code class="keyword">END DO</code></a>
    <a href="main_p.html#maini31" target="origFile"><code class="keyword">WHERE </code>(t .GE. <code class="constant">0.0</code>) </a>
<a name="main_di44"></a>      <a href="main_p.html#maini43" target="origFile">abs0 = t</a>
    <a href="main_p.html#maini31" target="origFile"><code class="keyword">ELSEWHERE</code></a>
<a name="main_di45"></a>      <a href="main_p.html#maini44" target="origFile">abs0 = -t</a>
<a name="main_di46"></a>    <a href="main_p.html#maini31" target="origFile"><code class="keyword">END WHERE</code></a>
<a name="main_di47"></a>    <a href="main_p.html#maini45" target="origFile">error = <code class="funcname">SUM</code>(temp)/<code class="funcname">SUM</code>(abs0)</a>
    <a href="main_p.html#maini46" target="origFile"><code class="keyword">PRINT*</code>, error</a>
    <a href="main_p.html#maini47" target="origFile"><code class="keyword">IF</code> (error .LT. tol) <code class="keyword">THEN</code></a>
<a name="main_di48"></a>      <a href="main_p.html#maini47" target="origFile"><code class="keyword">GOTO </code><code class="label">100</code></a>
    <a href="main_p.html#maini47" target="origFile"><code class="keyword">ELSE</code></a>
      <a href="main_p.html#maini48" target="origFile">ncount = ncount + <code class="constant">1</code></a>
<a name="main_di49"></a>    <a href="main_p.html#maini47" target="origFile"><code class="keyword">END IF</code></a>
  <a href="main_p.html#maini31" target="origFile"><code class="keyword">END DO</code></a>
 <a href="main_p.html#main" target="origFile"><code class="label">100 </code></a><a href="main_p.html#maini49" target="origFile"><code class="keyword">PRINT*</code>, <code class="string">'solution converged with residual:'</code>, error, <code class="string">'after'</code>, ncount<code class="label">&</code></a>
<a href="main_p.html#maini49" target="origFile"><code class="label">&    </code>, <code class="string">'iterations'</code></a>
<a href="main_p.html#main" target="origFile"><code class="keyword">END PROGRAM </code><code class="funcname">MAIN_D</code></a>
</pre>
</body>
