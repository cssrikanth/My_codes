<title>Generated by TAPENADE</title>
<link type="text/CSS" rel="stylesheet" href="tapenade.css">
<link type="text/CSS" rel="stylesheet" href="fortranStyle.css">
<body>
<pre><a name="main"></a><a href="main_d.html#main_d" target="diffFile"><code class="comment">!        Generated by TAPENADE     (INRIA, Tropics team)</code></a>
<a href="main_d.html#main_d" target="diffFile"><code class="comment">!  Tapenade 3.9 (r5096) - 24 Feb 2014 16:53</code></a>
<a href="main_d.html#main_d" target="diffFile"><code class="comment">!</code></a>
<a href="main_d.html#main_d" target="diffFile"><code class="keyword">PROGRAM </code><code class="funcname">MAIN</code></a>
  <a href="main_d.html#main_d" target="diffFile"><code class="keyword">USE </code><code class="funcname">DIFFSIZES</code></a>
<a href="main_d.html#main_d" target="diffFile"><code class="comment">!  Hint: ISIZE1OFabs should be the size of dimension 1 of array abs</code></a>
<a href="main_d.html#main_d" target="diffFile"><code class="comment">!  Hint: ISIZE2OFabs should be the size of dimension 2 of array abs</code></a>
  <a href="main_d.html#main_d" target="diffFile"><code class="keyword">IMPLICIT NONE</code></a>
  <a href="main_d.html#main_d" target="diffFile"><code class="typename">INTEGER </code>:: <code class="vardecl">n</code>, <code class="vardecl">ncount</code>, <code class="vardecl">i</code>, <code class="vardecl">j</code></a>
  <a href="main_d.html#main_d" target="diffFile"><code class="typename">REAL </code>:: <code class="vardecl">dx</code>, <code class="vardecl">error</code>, <code class="vardecl">tol</code>, <code class="vardecl">lent</code>, <code class="vardecl">pertub</code></a>
<a href="main_d.html#main_d" target="diffFile"><code class="comment">!      real,allocatable,intent(in),dimension(:,:)::k</code></a>
  <a href="main_d.html#main_d" target="diffFile"><code class="typename">REAL </code>:: <code class="vardecl">func</code></a>
  <a href="main_d.html#main_d" target="diffFile"><code class="typename">REAL</code>, <code class="typename">DIMENSION(</code>:, :<code class="typename">)</code>, <code class="typename">ALLOCATABLE </code>:: <code class="vardecl">t</code>, <code class="vardecl">x</code>, <code class="vardecl">y</code>, <code class="vardecl">oldt</code>, <code class="vardecl">temp</code>, <code class="vardecl">k</code></a>
  <a href="main_d.html#main_d" target="diffFile"><code class="keyword">INTRINSIC </code><code class="funcname">SUM</code></a>
  <a href="main_d.html#main_d" target="diffFile"><code class="keyword">INTRINSIC </code><code class="funcname">ABS</code></a>
  <a href="main_d.html#main_d" target="diffFile"><code class="typename">REAL </code>:: <code class="vardecl">abs0</code>(<code class="vardecl">ISIZE1OFabs</code>, <code class="vardecl">ISIZE2OFabs</code>)</a>
<a href="main_d.html#main_d" target="diffFile"><code class="comment">!grid details</code></a>
  <a href="main_d.html#main_d" target="diffFile">n = <code class="constant">100</code></a>
  <a href="main_d.html#main_d" target="diffFile"><code class="keyword">ALLOCATE(</code>t<code class="keyword">(</code>n, n<code class="keyword">))</code></a>
  <a href="main_d.html#main_d" target="diffFile"><code class="keyword">ALLOCATE(</code>oldt<code class="keyword">(</code>n, n<code class="keyword">))</code></a>
  <a href="main_d.html#main_d" target="diffFile"><code class="keyword">ALLOCATE(</code>temp<code class="keyword">(</code>n, n<code class="keyword">))</code></a>
  <a href="main_d.html#main_d" target="diffFile"><code class="keyword">ALLOCATE(</code>k<code class="keyword">(</code>n, n<code class="keyword">))</code></a>
<a href="main_d.html#main_d" target="diffFile"><code class="comment">!solution details</code></a>
  <a href="main_d.html#main_d" target="diffFile">error = <code class="constant">0.0</code></a>
  <a href="main_d.html#main_d" target="diffFile">tol = <code class="constant">1e-8</code></a>
  <a href="main_d.html#main_d" target="diffFile">ncount = <code class="constant">0</code></a>
  <a href="main_d.html#main_d" target="diffFile">pertub = <code class="constant">0</code></a>
<a href="main_d.html#main_d" target="diffFile"><code class="comment">!initial guess and bc</code></a>
  <a href="main_d.html#main_d" target="diffFile"><code class="keyword">DO </code>i=<code class="constant">1</code>,n</a>
    <a href="main_d.html#main_d" target="diffFile"><code class="keyword">DO </code>j=<code class="constant">1</code>,n</a>
      <a href="main_d.html#main_d" target="diffFile"><code class="keyword">IF</code> (i .EQ. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
        <a href="main_d.html#main_d" target="diffFile">t(i, j) = <code class="constant">10</code></a>
        <a href="main_d.html#main_d" target="diffFile">k(i, j) = <code class="constant">10 </code>+ pertub</a>
      <a href="main_d.html#main_d" target="diffFile"><code class="keyword">ELSE IF</code> (j .EQ. <code class="constant">0</code>) <code class="keyword">THEN</code></a>
        <a href="main_d.html#main_d" target="diffFile">t(i, j) = <code class="constant">20</code></a>
        <a href="main_d.html#main_d" target="diffFile">k(i, j) = <code class="constant">5 </code>+ pertub</a>
      <a href="main_d.html#main_d" target="diffFile"><code class="keyword">ELSE IF</code> (i .EQ. n) <code class="keyword">THEN</code></a>
        <a href="main_d.html#main_d" target="diffFile">t(i, j) = <code class="constant">20</code></a>
        <a href="main_d.html#main_d" target="diffFile">k(i, j) = <code class="constant">1 </code>+ pertub</a>
      <a href="main_d.html#main_d" target="diffFile"><code class="keyword">ELSE IF</code> (j .EQ. n) <code class="keyword">THEN</code></a>
        <a href="main_d.html#main_d" target="diffFile">t(i, j) = <code class="constant">40</code></a>
        <a href="main_d.html#main_d" target="diffFile">k(i, j) = <code class="constant">50 </code>+ pertub</a>
      <a href="main_d.html#main_d" target="diffFile"><code class="keyword">ELSE</code></a>
        <a href="main_d.html#main_d" target="diffFile">t(i, j) = <code class="constant">0.0</code></a>
        <a href="main_d.html#main_d" target="diffFile">k(i, j) = <code class="constant">60 </code>+ pertub</a>
      <a href="main_d.html#main_d" target="diffFile"><code class="keyword">END IF</code></a>
    <a href="main_d.html#main_d" target="diffFile"><code class="keyword">END DO</code></a>
  <a href="main_d.html#main_d" target="diffFile"><code class="keyword">END DO</code></a>
<a href="main_d.html#main_d" target="diffFile"><code class="comment">!solver</code></a>
  <a href="main_d.html#main_d" target="diffFile"><code class="keyword">DO </code></a>
    <a href="main_d.html#main_d" target="diffFile">oldt = t</a>
    <a href="main_d.html#main_d" target="diffFile"><code class="keyword">DO </code>i=<code class="constant">2</code>,n-<code class="constant">1</code></a>
      <a href="main_d.html#main_d" target="diffFile"><code class="keyword">DO </code>j=<code class="constant">2</code>,n-<code class="constant">1</code></a>
        <a href="main_d.html#main_d" target="diffFile">t(i, j) = (t(i+<code class="constant">1</code>, j)*k(i+<code class="constant">1</code>, j)+t(i-<code class="constant">1</code>, j)*k(i-<code class="constant">1</code>, j)+t(i, j+<code class="constant">1</code>)*k(i<code class="label">&</code></a>
<a href="main_d.html#main_d" target="diffFile"><code class="label">&         </code>, j+<code class="constant">1</code>)+t(i, j-<code class="constant">1</code>)*k(i, j-<code class="constant">1</code>))/(k(i+<code class="constant">1</code>, j)+k(i-<code class="constant">1</code>, j)+k(i, j+<code class="constant">1</code>)+k(i<code class="label">&</code></a>
<a href="main_d.html#main_d" target="diffFile"><code class="label">&         </code>, j-<code class="constant">1</code>))</a>
      <a href="main_d.html#main_d" target="diffFile"><code class="keyword">END DO</code></a>
    <a href="main_d.html#main_d" target="diffFile"><code class="keyword">END DO</code></a>
<a href="main_d.html#main_d" target="diffFile"><code class="comment">!objective func</code></a>
    <a href="main_d.html#main_d" target="diffFile">func = <code class="funcname">SUM</code>(t)</a>
<a href="main_d.html#main_d" target="diffFile"><code class="comment">!     call solver(t,k,n)</code></a>
    <a href="main_d.html#main_d" target="diffFile"><code class="keyword">DO </code>i=<code class="constant">2</code>,n-<code class="constant">1</code></a>
      <a href="main_d.html#main_d" target="diffFile"><code class="keyword">DO </code>j=<code class="constant">2</code>,n-<code class="constant">1</code></a>
        <a href="main_d.html#main_d" target="diffFile"><code class="keyword">IF</code> (t(i, j) - oldt(i, j) .GE. <code class="constant">0.</code>) <code class="keyword">THEN</code></a>
          <a href="main_d.html#main_d" target="diffFile">temp(i, j) = t(i, j) - oldt(i, j)</a>
        <a href="main_d.html#main_d" target="diffFile"><code class="keyword">ELSE</code></a>
          <a href="main_d.html#main_d" target="diffFile">temp(i, j) = -(t(i, j)-oldt(i, j))</a>
        <a href="main_d.html#main_d" target="diffFile"><code class="keyword">END IF</code></a>
      <a href="main_d.html#main_d" target="diffFile"><code class="keyword">END DO</code></a>
    <a href="main_d.html#main_d" target="diffFile"><code class="keyword">END DO</code></a>
    <a href="main_d.html#main_d" target="diffFile"><code class="keyword">WHERE </code>(t .GE. <code class="constant">0.0</code>) </a>
      <a href="main_d.html#main_d" target="diffFile">abs0 = t</a>
    <a href="main_d.html#main_d" target="diffFile"><code class="keyword">ELSEWHERE</code></a>
      <a href="main_d.html#main_d" target="diffFile">abs0 = -t</a>
    <a href="main_d.html#main_d" target="diffFile"><code class="keyword">END WHERE</code></a>
    <a href="main_d.html#main_d" target="diffFile">error = <code class="funcname">SUM</code>(temp)/<code class="funcname">SUM</code>(abs0)</a>
    <a href="main_d.html#main_d" target="diffFile"><code class="keyword">PRINT*</code>, error</a>
    <a href="main_d.html#main_d" target="diffFile"><code class="keyword">IF</code> (error .LT. tol) <code class="keyword">THEN</code></a>
      <a href="main_d.html#main_d" target="diffFile"><code class="keyword">GOTO </code><code class="label">100</code></a>
    <a href="main_d.html#main_d" target="diffFile"><code class="keyword">ELSE</code></a>
      <a href="main_d.html#main_d" target="diffFile">ncount = ncount + <code class="constant">1</code></a>
    <a href="main_d.html#main_d" target="diffFile"><code class="keyword">END IF</code></a>
  <a href="main_d.html#main_d" target="diffFile"><code class="keyword">END DO</code></a>
 <a href="main_d.html#main_d" target="diffFile"><code class="label">100 </code><code class="keyword">PRINT*</code>, <code class="string">'solution converged with residual:'</code>, error, <code class="string">'after'</code>, ncount<code class="label">&</code></a>
<a href="main_d.html#main_d" target="diffFile"><code class="label">&    </code>, <code class="string">'iterations'</code></a>
<a href="main_d.html#main_d" target="diffFile"><code class="keyword">END PROGRAM </code><code class="funcname">MAIN</code></a>
</pre>
</body>
